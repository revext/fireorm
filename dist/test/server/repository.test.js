"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
const firebase_admin_1 = __importDefault(require("firebase-admin"));
const src_1 = require("../../src");
const models_1 = require("../data/models");
const ServerEngine_1 = __importDefault(require("../../src/engine/ServerEngine"));
const repositories_1 = require("../data/repositories");
let dogRepository = null;
let catRepository = null;
let humanRepository = null;
firebase_admin_1.default.initializeApp({
    credential: firebase_admin_1.default.credential.cert(require('../../service-account.json'))
});
(0, src_1.startOrm)(new ServerEngine_1.default(firebase_admin_1.default.app()));
(0, src_1.registerRepositories)([repositories_1.DogRepository, repositories_1.HumanRepository, repositories_1.CatRepository]);
beforeAll(async () => {
    dogRepository = (0, src_1.getRepositoryFor)(models_1.Dog);
    humanRepository = (0, src_1.getRepositoryFor)(models_1.Human);
    catRepository = (0, src_1.getRepositoryFor)(models_1.Cat);
    await firebase_admin_1.default.firestore().collection('humans').doc('1').set({
        name: 'John'
    });
    await firebase_admin_1.default.firestore().collection('humans').doc('2').set({
        name: 'Jim'
    });
    await firebase_admin_1.default.firestore().collection('humans/1/dogs').doc('1').set({
        name: 'Fido',
        bones: [
            { length: 10 },
            { length: 20 },
        ]
    });
    await firebase_admin_1.default.firestore().collection('humans/1/cats').doc('1').set({
        name: 'Leprechaun'
    });
});
afterAll(async () => {
    await firebase_admin_1.default.firestore().collection('humans/1/cats').doc('1').delete();
    await firebase_admin_1.default.firestore().collection('humans/1/dogs').doc('1').delete();
    await firebase_admin_1.default.firestore().collection('humans').doc('1').delete();
    await firebase_admin_1.default.firestore().collection('humans').doc('2').delete();
});
test('loadMany on model by repository', async () => {
    const cat = await catRepository.load("1", { humanId: "1" });
    console.log(cat);
    await cat.loadMany(['human', 'human.dogs']);
    expect(cat.name).toBe("Leprechaun");
    expect(cat.human.name).toBe("John");
    expect(cat.human.dogs[0].id).toBe("1");
    expect(cat.human.dogs[0].name).toBe("Fido");
});
test('load by id on repository', async () => {
    const human = await humanRepository.load("1");
    expect(human.name).toBe('John');
});
test('loadMany by ids on repository', async () => {
    const humans = await humanRepository.loadMany(["1", "2"]);
    expect(humans.length).toBe(2);
    expect(humans[0].name).toBe('John');
    expect(humans[1].name).toBe('Jim');
});
test('loadMany on model by repository', async () => {
    const human = await humanRepository.load("1");
    await human.load('relatives');
    human.relatives;
    expect(human.relatives.length).toBe(1);
    expect(human.relatives[0].name).toBe('Jim');
});
test('load by id with additional route params on repository', async () => {
    const dog = await dogRepository.load("1", { humanId: "1" });
    expect(dog.name).toBe('Fido');
    expect(dog.bones[0].length).toBe(10);
    expect(dog.bones[1].length).toBe(20);
});
test('load subcollection on model with repository', async () => {
    const human = await humanRepository.load("1");
    await human.load("dogs");
    expect(human.dogs.length).toBe(1);
    expect(human.dogs[0].name).toBe("Fido");
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicmVwb3NpdG9yeS50ZXN0LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vdGVzdC9zZXJ2ZXIvcmVwb3NpdG9yeS50ZXN0LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7O0FBQUEsb0VBQWtDO0FBQ2xDLG1DQUE4RTtBQUM5RSwyQ0FBZ0Q7QUFDaEQsaUZBQXdEO0FBQ3hELHVEQUFvRjtBQUdwRixJQUFJLGFBQWEsR0FBa0IsSUFBSSxDQUFBO0FBQ3ZDLElBQUksYUFBYSxHQUFrQixJQUFJLENBQUE7QUFDdkMsSUFBSSxlQUFlLEdBQW9CLElBQUksQ0FBQTtBQUUzQyx3QkFBSyxDQUFDLGFBQWEsQ0FBQztJQUNoQixVQUFVLEVBQUUsd0JBQUssQ0FBQyxVQUFVLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyw0QkFBNEIsQ0FBQyxDQUFDO0NBQzNFLENBQUMsQ0FBQTtBQUNGLElBQUEsY0FBUSxFQUFDLElBQUksc0JBQVksQ0FBQyx3QkFBSyxDQUFDLEdBQUcsRUFBRSxDQUFDLENBQUMsQ0FBQTtBQUV2QyxJQUFBLDBCQUFvQixFQUFDLENBQUMsNEJBQWEsRUFBRSw4QkFBZSxFQUFFLDRCQUFhLENBQUMsQ0FBQyxDQUFBO0FBRXJFLFNBQVMsQ0FBQyxLQUFLLElBQUksRUFBRTtJQUNqQixhQUFhLEdBQUcsSUFBQSxzQkFBZ0IsRUFBQyxZQUFHLENBQUMsQ0FBQTtJQUNyQyxlQUFlLEdBQUcsSUFBQSxzQkFBZ0IsRUFBQyxjQUFLLENBQUMsQ0FBQTtJQUN6QyxhQUFhLEdBQUcsSUFBQSxzQkFBZ0IsRUFBQyxZQUFHLENBQUMsQ0FBQTtJQUVyQyxNQUFNLHdCQUFLLENBQUMsU0FBUyxFQUFFLENBQUMsVUFBVSxDQUFDLFFBQVEsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxHQUFHLENBQUMsQ0FBQyxHQUFHLENBQUM7UUFDdEQsSUFBSSxFQUFFLE1BQU07S0FDZixDQUFDLENBQUE7SUFDRixNQUFNLHdCQUFLLENBQUMsU0FBUyxFQUFFLENBQUMsVUFBVSxDQUFDLFFBQVEsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxHQUFHLENBQUMsQ0FBQyxHQUFHLENBQUM7UUFDdEQsSUFBSSxFQUFFLEtBQUs7S0FDZCxDQUFDLENBQUE7SUFDRixNQUFNLHdCQUFLLENBQUMsU0FBUyxFQUFFLENBQUMsVUFBVSxDQUFDLGVBQWUsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxHQUFHLENBQUMsQ0FBQyxHQUFHLENBQUM7UUFDN0QsSUFBSSxFQUFFLE1BQU07UUFDWixLQUFLLEVBQUU7WUFDSCxFQUFFLE1BQU0sRUFBRSxFQUFFLEVBQUU7WUFDZCxFQUFFLE1BQU0sRUFBRSxFQUFFLEVBQUU7U0FDakI7S0FDSixDQUFDLENBQUE7SUFDRixNQUFNLHdCQUFLLENBQUMsU0FBUyxFQUFFLENBQUMsVUFBVSxDQUFDLGVBQWUsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxHQUFHLENBQUMsQ0FBQyxHQUFHLENBQUM7UUFDN0QsSUFBSSxFQUFFLFlBQVk7S0FDckIsQ0FBQyxDQUFBO0FBQ04sQ0FBQyxDQUFDLENBQUM7QUFFSCxRQUFRLENBQUMsS0FBSyxJQUFJLEVBQUU7SUFDaEIsTUFBTSx3QkFBSyxDQUFDLFNBQVMsRUFBRSxDQUFDLFVBQVUsQ0FBQyxlQUFlLENBQUMsQ0FBQyxHQUFHLENBQUMsR0FBRyxDQUFDLENBQUMsTUFBTSxFQUFFLENBQUE7SUFDckUsTUFBTSx3QkFBSyxDQUFDLFNBQVMsRUFBRSxDQUFDLFVBQVUsQ0FBQyxlQUFlLENBQUMsQ0FBQyxHQUFHLENBQUMsR0FBRyxDQUFDLENBQUMsTUFBTSxFQUFFLENBQUE7SUFDckUsTUFBTSx3QkFBSyxDQUFDLFNBQVMsRUFBRSxDQUFDLFVBQVUsQ0FBQyxRQUFRLENBQUMsQ0FBQyxHQUFHLENBQUMsR0FBRyxDQUFDLENBQUMsTUFBTSxFQUFFLENBQUE7SUFDOUQsTUFBTSx3QkFBSyxDQUFDLFNBQVMsRUFBRSxDQUFDLFVBQVUsQ0FBQyxRQUFRLENBQUMsQ0FBQyxHQUFHLENBQUMsR0FBRyxDQUFDLENBQUMsTUFBTSxFQUFFLENBQUE7QUFDbEUsQ0FBQyxDQUFDLENBQUM7QUFFSCxJQUFJLENBQUMsaUNBQWlDLEVBQUUsS0FBSyxJQUFJLEVBQUU7SUFDL0MsTUFBTSxHQUFHLEdBQUcsTUFBTSxhQUFhLENBQUMsSUFBSSxDQUFDLEdBQUcsRUFBRSxFQUFFLE9BQU8sRUFBRSxHQUFHLEVBQUMsQ0FBQyxDQUFBO0lBQzFELE9BQU8sQ0FBQyxHQUFHLENBQUMsR0FBRyxDQUFDLENBQUE7SUFDaEIsTUFBTSxHQUFHLENBQUMsUUFBUSxDQUFDLENBQUMsT0FBTyxFQUFFLFlBQVksQ0FBQyxDQUFDLENBQUE7SUFFM0MsTUFBTSxDQUFDLEdBQUcsQ0FBQyxJQUFJLENBQUMsQ0FBQyxJQUFJLENBQUMsWUFBWSxDQUFDLENBQUE7SUFDbkMsTUFBTSxDQUFDLEdBQUcsQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxDQUFBO0lBQ25DLE1BQU0sQ0FBQyxHQUFHLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUE7SUFDdEMsTUFBTSxDQUFDLEdBQUcsQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsQ0FBQTtBQUMvQyxDQUFDLENBQUMsQ0FBQTtBQUVGLElBQUksQ0FBQywwQkFBMEIsRUFBRSxLQUFLLElBQUksRUFBRTtJQUN4QyxNQUFNLEtBQUssR0FBRyxNQUFNLGVBQWUsQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUE7SUFFN0MsTUFBTSxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLENBQUE7QUFDbkMsQ0FBQyxDQUFDLENBQUE7QUFFRixJQUFJLENBQUMsK0JBQStCLEVBQUUsS0FBSyxJQUFJLEVBQUU7SUFDN0MsTUFBTSxNQUFNLEdBQUcsTUFBTSxlQUFlLENBQUMsUUFBUSxDQUFDLENBQUMsR0FBRyxFQUFFLEdBQUcsQ0FBQyxDQUFDLENBQUE7SUFFekQsTUFBTSxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUE7SUFDN0IsTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLENBQUE7SUFDbkMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUE7QUFDdEMsQ0FBQyxDQUFDLENBQUE7QUFFRixJQUFJLENBQUMsaUNBQWlDLEVBQUUsS0FBSyxJQUFJLEVBQUU7SUFDL0MsTUFBTSxLQUFLLEdBQUcsTUFBTSxlQUFlLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFBO0lBQzdDLE1BQU0sS0FBSyxDQUFDLElBQUksQ0FBQyxXQUFXLENBQUMsQ0FBQTtJQUM3QixLQUFLLENBQUMsU0FBUyxDQUFBO0lBRWYsTUFBTSxDQUFDLEtBQUssQ0FBQyxTQUFTLENBQUMsTUFBTSxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFBO0lBQ3RDLE1BQU0sQ0FBQyxLQUFLLENBQUMsU0FBUyxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQTtBQUMvQyxDQUFDLENBQUMsQ0FBQTtBQUVGLElBQUksQ0FBQyx1REFBdUQsRUFBRSxLQUFLLElBQUksRUFBRTtJQUNyRSxNQUFNLEdBQUcsR0FBRyxNQUFNLGFBQWEsQ0FBQyxJQUFJLENBQUMsR0FBRyxFQUFFLEVBQUUsT0FBTyxFQUFFLEdBQUcsRUFBRSxDQUFDLENBQUE7SUFFM0QsTUFBTSxDQUFDLEdBQUcsQ0FBQyxJQUFJLENBQUMsQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLENBQUE7SUFDN0IsTUFBTSxDQUFDLEdBQUcsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUMsTUFBTSxDQUFDLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxDQUFBO0lBQ3BDLE1BQU0sQ0FBQyxHQUFHLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxDQUFDLElBQUksQ0FBQyxFQUFFLENBQUMsQ0FBQTtBQUN4QyxDQUFDLENBQUMsQ0FBQTtBQUVGLElBQUksQ0FBQyw2Q0FBNkMsRUFBRSxLQUFLLElBQUksRUFBRTtJQUMzRCxNQUFNLEtBQUssR0FBRyxNQUFNLGVBQWUsQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUE7SUFFN0MsTUFBTSxLQUFLLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxDQUFBO0lBQ3hCLE1BQU0sQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQTtJQUNqQyxNQUFNLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLENBQUE7QUFDM0MsQ0FBQyxDQUFDLENBQUEiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgYWRtaW4gZnJvbSAnZmlyZWJhc2UtYWRtaW4nXHJcbmltcG9ydCB7ICBzdGFydE9ybSwgIGdldFJlcG9zaXRvcnlGb3IsIHJlZ2lzdGVyUmVwb3NpdG9yaWVzIH0gZnJvbSBcIi4uLy4uL3NyY1wiXHJcbmltcG9ydCB7IEh1bWFuLCBEb2csIENhdCB9IGZyb20gXCIuLi9kYXRhL21vZGVsc1wiXHJcbmltcG9ydCBTZXJ2ZXJFbmdpbmUgZnJvbSAnLi4vLi4vc3JjL2VuZ2luZS9TZXJ2ZXJFbmdpbmUnXHJcbmltcG9ydCB7IERvZ1JlcG9zaXRvcnksIEh1bWFuUmVwb3NpdG9yeSwgQ2F0UmVwb3NpdG9yeSB9IGZyb20gJy4uL2RhdGEvcmVwb3NpdG9yaWVzJ1xyXG5cclxuXHJcbmxldCBkb2dSZXBvc2l0b3J5OiBEb2dSZXBvc2l0b3J5ID0gbnVsbFxyXG5sZXQgY2F0UmVwb3NpdG9yeTogQ2F0UmVwb3NpdG9yeSA9IG51bGxcclxubGV0IGh1bWFuUmVwb3NpdG9yeTogSHVtYW5SZXBvc2l0b3J5ID0gbnVsbFxyXG5cclxuYWRtaW4uaW5pdGlhbGl6ZUFwcCh7XHJcbiAgICBjcmVkZW50aWFsOiBhZG1pbi5jcmVkZW50aWFsLmNlcnQocmVxdWlyZSgnLi4vLi4vc2VydmljZS1hY2NvdW50Lmpzb24nKSlcclxufSlcclxuc3RhcnRPcm0obmV3IFNlcnZlckVuZ2luZShhZG1pbi5hcHAoKSkpXHJcblxyXG5yZWdpc3RlclJlcG9zaXRvcmllcyhbRG9nUmVwb3NpdG9yeSwgSHVtYW5SZXBvc2l0b3J5LCBDYXRSZXBvc2l0b3J5XSlcclxuXHJcbmJlZm9yZUFsbChhc3luYyAoKSA9PiB7XHJcbiAgICBkb2dSZXBvc2l0b3J5ID0gZ2V0UmVwb3NpdG9yeUZvcihEb2cpXHJcbiAgICBodW1hblJlcG9zaXRvcnkgPSBnZXRSZXBvc2l0b3J5Rm9yKEh1bWFuKVxyXG4gICAgY2F0UmVwb3NpdG9yeSA9IGdldFJlcG9zaXRvcnlGb3IoQ2F0KVxyXG5cclxuICAgIGF3YWl0IGFkbWluLmZpcmVzdG9yZSgpLmNvbGxlY3Rpb24oJ2h1bWFucycpLmRvYygnMScpLnNldCh7XHJcbiAgICAgICAgbmFtZTogJ0pvaG4nXHJcbiAgICB9KVxyXG4gICAgYXdhaXQgYWRtaW4uZmlyZXN0b3JlKCkuY29sbGVjdGlvbignaHVtYW5zJykuZG9jKCcyJykuc2V0KHtcclxuICAgICAgICBuYW1lOiAnSmltJ1xyXG4gICAgfSlcclxuICAgIGF3YWl0IGFkbWluLmZpcmVzdG9yZSgpLmNvbGxlY3Rpb24oJ2h1bWFucy8xL2RvZ3MnKS5kb2MoJzEnKS5zZXQoe1xyXG4gICAgICAgIG5hbWU6ICdGaWRvJyxcdFxyXG4gICAgICAgIGJvbmVzOiBbXHJcbiAgICAgICAgICAgIHsgbGVuZ3RoOiAxMCB9LFxyXG4gICAgICAgICAgICB7IGxlbmd0aDogMjAgfSxcclxuICAgICAgICBdXHJcbiAgICB9KVxyXG4gICAgYXdhaXQgYWRtaW4uZmlyZXN0b3JlKCkuY29sbGVjdGlvbignaHVtYW5zLzEvY2F0cycpLmRvYygnMScpLnNldCh7XHJcbiAgICAgICAgbmFtZTogJ0xlcHJlY2hhdW4nXHJcbiAgICB9KVxyXG59KTtcclxuXHJcbmFmdGVyQWxsKGFzeW5jICgpID0+IHtcclxuICAgIGF3YWl0IGFkbWluLmZpcmVzdG9yZSgpLmNvbGxlY3Rpb24oJ2h1bWFucy8xL2NhdHMnKS5kb2MoJzEnKS5kZWxldGUoKVxyXG4gICAgYXdhaXQgYWRtaW4uZmlyZXN0b3JlKCkuY29sbGVjdGlvbignaHVtYW5zLzEvZG9ncycpLmRvYygnMScpLmRlbGV0ZSgpXHJcbiAgICBhd2FpdCBhZG1pbi5maXJlc3RvcmUoKS5jb2xsZWN0aW9uKCdodW1hbnMnKS5kb2MoJzEnKS5kZWxldGUoKVxyXG4gICAgYXdhaXQgYWRtaW4uZmlyZXN0b3JlKCkuY29sbGVjdGlvbignaHVtYW5zJykuZG9jKCcyJykuZGVsZXRlKClcclxufSk7XHJcblxyXG50ZXN0KCdsb2FkTWFueSBvbiBtb2RlbCBieSByZXBvc2l0b3J5JywgYXN5bmMgKCkgPT4ge1xyXG4gICAgY29uc3QgY2F0ID0gYXdhaXQgY2F0UmVwb3NpdG9yeS5sb2FkKFwiMVwiLCB7IGh1bWFuSWQ6IFwiMVwifSlcclxuICAgIGNvbnNvbGUubG9nKGNhdClcclxuICAgIGF3YWl0IGNhdC5sb2FkTWFueShbJ2h1bWFuJywgJ2h1bWFuLmRvZ3MnXSlcclxuXHJcbiAgICBleHBlY3QoY2F0Lm5hbWUpLnRvQmUoXCJMZXByZWNoYXVuXCIpXHJcbiAgICBleHBlY3QoY2F0Lmh1bWFuLm5hbWUpLnRvQmUoXCJKb2huXCIpXHJcbiAgICBleHBlY3QoY2F0Lmh1bWFuLmRvZ3NbMF0uaWQpLnRvQmUoXCIxXCIpXHJcbiAgICBleHBlY3QoY2F0Lmh1bWFuLmRvZ3NbMF0ubmFtZSkudG9CZShcIkZpZG9cIilcclxufSlcclxuXHJcbnRlc3QoJ2xvYWQgYnkgaWQgb24gcmVwb3NpdG9yeScsIGFzeW5jICgpID0+IHtcclxuICAgIGNvbnN0IGh1bWFuID0gYXdhaXQgaHVtYW5SZXBvc2l0b3J5LmxvYWQoXCIxXCIpXHJcblxyXG4gICAgZXhwZWN0KGh1bWFuLm5hbWUpLnRvQmUoJ0pvaG4nKVxyXG59KVxyXG5cclxudGVzdCgnbG9hZE1hbnkgYnkgaWRzIG9uIHJlcG9zaXRvcnknLCBhc3luYyAoKSA9PiB7XHJcbiAgICBjb25zdCBodW1hbnMgPSBhd2FpdCBodW1hblJlcG9zaXRvcnkubG9hZE1hbnkoW1wiMVwiLCBcIjJcIl0pXHJcblxyXG4gICAgZXhwZWN0KGh1bWFucy5sZW5ndGgpLnRvQmUoMilcclxuICAgIGV4cGVjdChodW1hbnNbMF0ubmFtZSkudG9CZSgnSm9obicpXHJcbiAgICBleHBlY3QoaHVtYW5zWzFdLm5hbWUpLnRvQmUoJ0ppbScpXHJcbn0pXHJcblxyXG50ZXN0KCdsb2FkTWFueSBvbiBtb2RlbCBieSByZXBvc2l0b3J5JywgYXN5bmMgKCkgPT4ge1xyXG4gICAgY29uc3QgaHVtYW4gPSBhd2FpdCBodW1hblJlcG9zaXRvcnkubG9hZChcIjFcIilcclxuICAgIGF3YWl0IGh1bWFuLmxvYWQoJ3JlbGF0aXZlcycpXHJcbiAgICBodW1hbi5yZWxhdGl2ZXNcclxuXHJcbiAgICBleHBlY3QoaHVtYW4ucmVsYXRpdmVzLmxlbmd0aCkudG9CZSgxKVxyXG4gICAgZXhwZWN0KGh1bWFuLnJlbGF0aXZlc1swXS5uYW1lKS50b0JlKCdKaW0nKVxyXG59KVxyXG5cclxudGVzdCgnbG9hZCBieSBpZCB3aXRoIGFkZGl0aW9uYWwgcm91dGUgcGFyYW1zIG9uIHJlcG9zaXRvcnknLCBhc3luYyAoKSA9PiB7XHJcbiAgICBjb25zdCBkb2cgPSBhd2FpdCBkb2dSZXBvc2l0b3J5LmxvYWQoXCIxXCIsIHsgaHVtYW5JZDogXCIxXCIgfSlcclxuXHJcbiAgICBleHBlY3QoZG9nLm5hbWUpLnRvQmUoJ0ZpZG8nKVxyXG4gICAgZXhwZWN0KGRvZy5ib25lc1swXS5sZW5ndGgpLnRvQmUoMTApXHJcbiAgICBleHBlY3QoZG9nLmJvbmVzWzFdLmxlbmd0aCkudG9CZSgyMClcclxufSlcclxuXHJcbnRlc3QoJ2xvYWQgc3ViY29sbGVjdGlvbiBvbiBtb2RlbCB3aXRoIHJlcG9zaXRvcnknLCBhc3luYyAoKSA9PiB7XHJcbiAgICBjb25zdCBodW1hbiA9IGF3YWl0IGh1bWFuUmVwb3NpdG9yeS5sb2FkKFwiMVwiKVxyXG5cclxuICAgIGF3YWl0IGh1bWFuLmxvYWQoXCJkb2dzXCIpXHJcbiAgICBleHBlY3QoaHVtYW4uZG9ncy5sZW5ndGgpLnRvQmUoMSlcclxuICAgIGV4cGVjdChodW1hbi5kb2dzWzBdLm5hbWUpLnRvQmUoXCJGaWRvXCIpXHJcbn0pIl19